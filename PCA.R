library(reshape2)
library(ggplot2)

result <- read.csv("Documents/School/7331_Malware/data/final_countinous.csv")

summary(result)

pc.result<-prcomp(result[,2:10],scale.=TRUE)
pc.scores<-pc.result$x
pc.scores<-data.frame(pc.scores)
pc.scores$HasDetections<-result$HasDetections

pc.result
summary(pc.result)
n <- dim(result[,2:10])[2]


#Scree plot
eigenvals<-(pc.result$sdev)^2
cumulative.prop<-cumsum(eigenvals/sum(eigenvals))
screePlotData <- data.frame( factor = 1:n, eigenvals = eigenvals/sum(eigenvals), cumulative.prop = cumulative.prop)
screePlotData <- melt(screePlotData, id = "factor")
PCAScreePlot <- ggplot(data = screePlotData,
                       aes(x=factor, y=value, colour=variable)) +
  ylab("Prop. Var. Explained") +
  geom_line(aes(linetype=variable), size=1) + 
  theme(legend.position="none") +
  scale_x_continuous("Factors", 1:n, 1:n) +
  ggtitle("PCA Screen Plot")
PCAScreePlot

plotsPC1vPC2 <- ggplot(data = pc.scores, aes(x = PC1, y = PC2)) +
  geom_point(aes(col=HasDetections), size=2)+
  ggtitle("PC1 Vs. PC2") + 
  theme(legend.position="none")
plotsPC1vPC2

plotsPC1vPC3 <- ggplot(data = pc.scores, aes(x = PC1, y = PC3)) +
  geom_point(aes(col=HasDetections), size=2)+
  ggtitle("PC1 Vs. PC3") + 
  theme(legend.position="none")
plotsPC1vPC3

plotsPC2vPC3 <- ggplot(data = pc.scores, aes(x = PC2, y = PC3)) +
  geom_point(aes(col=HasDetections), size=2)+
  ggtitle("PC2 Vs. PC3") + 
  theme(legend.position="none")
plotsPC2vPC3
