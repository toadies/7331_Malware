from dotenv import load_dotenv
import os
import pandas as pd
import mysql.connector as mariadb
from sqlalchemy import create_engine

load_dotenv()

print("Read File")
df = pd.read_csv("data/train.csv")
def rstr(df): return df.shape, df.apply(lambda x: [x.unique()])
# print(rstr(df))
print(df.info())

# sodsConn = mariadb.connect(
#    host=os.getenv("SODS_HOST"),
#    database=os.getenv("SODS_DATABASE"),
#    user=os.getenv("SODS_USERNAME"),
#    password=os.getenv("SODS_PASSWORD"))

print("Import Into MariaDB")
mariaEngine = create_engine("mysql+mysqlconnector://root@localhost:3306/malware", echo=False)

print("Insert Results")
df.to_sql("train", con=mariaEngine, if_exists="replace", chunksize=1000, index=False)